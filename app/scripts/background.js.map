{"version":3,"sources":["../scripts.babel/background.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,IAAI,QAAQ,GAAI,YAAY;AAC3B,QAAI,GAAG,GAAG,EAAE;QACX,SAAS,GAAG,EAAE;;;;;AAAC,AAKb,aAAS,eAAe,CAAC,GAAG,EAAE;AAC1B,YAAI,SAAS,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;AAC9B,qBAAS,CAAC,GAAG,CAAC,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC;SAC7C;AACD,eAAO;KACV;;;;;AAAA,AAKD,aAAS,iBAAiB,CAAC,MAAM,EAAE,GAAG,EAAE;AACpC,aAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;AAClD,gBAAI,MAAM,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,IAAI,MAAM,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG,EAAE;AAClF,uBAAO,IAAI,CAAC;aACf;SACJ;AACD,eAAO,KAAK,CAAC;KAChB;;;;;AAAA,AAKD,OAAG,CAAC,WAAW,GAAG,UAAU,MAAM,EAAE,GAAG,EAAE;AACrC,uBAAe,CAAC,GAAG,CAAC,CAAC;AACrB,YAAI,CAAC,iBAAiB,CAAC,MAAM,EAAE,GAAG,CAAC,EAAE;AACjC,qBAAS,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AAClC,qBAAS,CAAC,GAAG,CAAC,CAAC,KAAK,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;AACvD,mBAAO,IAAI,CAAC;SACf;AACD,eAAO,KAAK,CAAC;KAChB;;;;;AAAC,AAKF,OAAG,CAAC,GAAG,GAAG,YAAW;AACjB,eAAO,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;KAC5B;;;;;AAAC,AAKF,OAAG,CAAC,aAAa,GAAG,UAAS,GAAG,EAAE;AAC9B,uBAAe,CAAC,GAAG,CAAC,CAAC;AACrB,iBAAS,CAAC,GAAG,CAAC,CAAC,KAAK,EAAE,CAAC;AACvB,YAAI,QAAQ,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;AAClG,eAAO,QAAQ,CAAC;KACnB,CAAC;;AAEL,WAAO,GAAG,CAAC;CACX,EAAE,AAAC;;;;;AAAC,AAKL,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,WAAW,CAAC,UAAA,OAAO,EAAI;AAChD,WAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,OAAO,CAAC,eAAe,CAAC,CAAC;CACzD,CAAC;;;;;AAAC,AAKH,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,WAAW,CAAC,UAAS,GAAG,EAAE;AACrD,QAAI,MAAM,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;AAC7C,UAAM,CAAC,IAAI,CAAC,aAAa,CAAC;AACtB,YAAI,EAAE,kBAAkB,GAAC,MAAM,GAAC,IAAI;KACvC,CAAC,CAAC;CACN,CAAC;;;;;AAAC,AAKH,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,WAAW,CAClC,UAAS,OAAO,EAAE;AAChB,QAAI,OAAO,CAAC,OAAO,EAAE;AACjB,YAAI,QAAQ,CAAC,WAAW,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,GAAG,CAAC,EAAE;AACpD,kBAAM,CAAC,aAAa,CAAC,YAAY,CAAC,EAAC,IAAI,EAAE,GAAG,EAAC,CAAC,CAAC;AAC/C,kBAAM,CAAC,UAAU,CAAC,YAAU;AACxB,sBAAM,CAAC,aAAa,CAAC,YAAY,CAAC,EAAC,IAAI,EAAE,EAAE,EAAC,CAAC,CAAC;aACjD,EAAE,GAAG,CAAC,CAAC;SACX;KACJ;CACF,CAAC,CAAC","file":"background.js","sourcesContent":["'use strict';\n\nvar upButton = (function () {\n\tvar btn = {},\n\t\twarehouse = {};\n    \n    /**\n     * initialize recording of url in warehouse\n     */\n    function _addToWarehouse(url) {\n        if (warehouse[url] === undefined) {\n            warehouse[url] = { stack: [0], index: 0 };\n        }\n        return;\n    }\n    \n    /**\n     * detect if height is too close to existing values in stack\n     */\n    function _isAlreadyInStack(height, url) {\n        for (var i = 0; i < warehouse[url].stack.length; i++) {\n            if (height > warehouse[url].stack[i] - 100 && height < warehouse[url].stack[i] + 100) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    /**\n     * Add the height at url to the location stack\n     */\n    btn.addLocation = function (height, url) {\n        _addToWarehouse(url);\n        if (!_isAlreadyInStack(height, url)) {\n            warehouse[url].stack.push(height);\n            warehouse[url].index = warehouse[url].stack.length - 1;\n            return true;\n        }\n        return false;\n    };\n    \n    /**\n     * log the warehouse\n     */\n    btn.log = function() {\n        console.table(warehouse);\n    };\n    \n    /**\n     * Returns the last height from the stack at the url\n     */\n    btn.getPrevHeight = function(url) {\n        _addToWarehouse(url);\n        warehouse[url].index--;\n        var scrollTo = warehouse[url].stack[Math.abs(warehouse[url].index) % warehouse[url].stack.length];\n        return scrollTo;\n    };\n\n\treturn btn;\n}());\n\n/**\n * log the version\n */\nchrome.runtime.onInstalled.addListener(details => {\n  console.log('previousVersion', details.previousVersion);\n});\n\n/**\n * add click listener to the button click\n */\nchrome.browserAction.onClicked.addListener(function(tab) {\n    var height = upButton.getPrevHeight(tab.url);\n    chrome.tabs.executeScript({\n        code: 'window.scroll(0,'+height+');'\n    });\n});\n\n/**\n * listen for messages from content script\n */\nchrome.runtime.onMessage.addListener(\n  function(request) {\n    if (request.scrollY) {\n        if (upButton.addLocation(request.scrollY, request.url)) {\n            chrome.browserAction.setBadgeText({text: '+'});\n            window.setTimeout(function(){\n                chrome.browserAction.setBadgeText({text: ''});\n            }, 750);\n        }\n    }\n  });\n"]}